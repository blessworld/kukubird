(function(){if(!window.preloadimage){window["preloadimage"]={};}var r=new Array();var g=0;var f=-1;var n=false;var c=1;var d=6;function k(){r=[];g=0;f=-1;n=false;}window["preloadimage"]["preloadInit"]=k;function l(){if(f>=r.length-1){return false;}p(++f);$("div #currcomicpage img").eq(0).animate({width:"0"},{duration:200,complete:function(){$(this).remove();}});s();imgtext='<img class="frame" src="'+r[f].url+'">';$("div #currcomicpage").append(imgtext);var t=function(){var u=new Image();u.src=r[f].url;if(!r[f].hwratio){r[f].hwratio=u.height/u.width;}preloadimage.resizeImg();u.onload=function(){var v=u.height/u.width;if(v!=r[f].hwratio){r[f].hwratio=v;preloadimage.resizeImg();}};};if(f===0){setTimeout(t,300);}else{t();}$("#labelpageno").text("第"+(f+1).toString()+"页");return true;}window["preloadimage"]["onNextPage"]=l;function e(){if(f<=0){return false;}p(--f);$("div #currcomicpage img").eq(0).slideToggle(200,function(){$(this).remove();});s();imgtext='<img class="frame" src="'+r[f].url+'">';$("div #currcomicpage").append(imgtext);var t=new Image();t.src=r[f].url;preloadimage.resizeImg();t.onload=function(){var u=t.height/t.width;if(u!=r[f].hwratio){r[f].hwratio=u;preloadimage.resizeImg();}};$("#labelpageno").text("第"+(f+1).toString()+"页");return true;}window["preloadimage"]["onPrevPage"]=e;function b(t){$("div #currcomicpage img").eq(0).hide(100,function(){$(this).remove();});imgtext='<img src="'+r[t].url+'">"';$("div #currcomicpage img").append(imgtext);p(t);}window["preloadimage"]["jumpToPage"]=b;function o(t,v,u){urllist=[];need_intro=utils.getParam("need_intro");$.getJSON(website+"/getcomicpages?needintro="+need_intro+"&callback=?",{"comic_id":t,"vol":v,"capture":u},function(y){for(var x=0,w=y.imglist.length;x<w;x++){r.push({"url":y.imglist[x]});}$("#labeltotalpageno").text("共"+j().toString()+"页");l();utils.setParam("need_intro","False");});}window["preloadimage"]["ajaxRequest"]=o;function i(){var t=$("div #currcomicpage").find("img");hwratio=r[a()].hwratio;if($(window).width()>=$(window).height()){t.height($(window).height()-20);t.width($(t).height()/hwratio);$("div #currcomicpage img").css("margin-left",($(window).width()-t.width())/2);$("div #currcomicpage img").css("margin-top",0);}else{t.width($(window).width());t.height($(t).width()*hwratio);$("div #currcomicpage img").css("margin-bottom",($(window).height()-t.height())/2);$("div #currcomicpage img").css("margin-top",($(window).height()-t.height())/2);$("div #currcomicpage img").css("margin-left",0);}}window["preloadimage"]["resizeImg"]=i;function h(){n=!n;m();}window["preloadimage"]["setAutoTurnPage"]=h;function q(){return n;}window["preloadimage"]["isAutoTurnPage"]=q;function a(){return f;}window["preloadimage"]["getCurrPageNo"]=a;function j(){return r.length;}window["preloadimage"]["getTotalPageNo"]=j;function s(v){for(var u=1,t=$("div #currcomicpage img").length;u<t;u++){$("div #currcomicpage img").eq(u).remove();}}function p(v){min=(v-d)>0?(v-1):0;max=(v+d)>r.length?r.length:(v+d);for(var u=min;u<max;u++){var t=new Image();t.src=r[u].url;}}function m(){if(n){if(controllers.comicpages.swipeleft()){setTimeout("preloadimage._begin_auto_turn_page()",10000);}}}window["preloadimage"]["_begin_auto_turn_page"]=m;})();